template(name='tribes')
    .ui.stackable.padded.grid
        .row
            .four.wide.column
                +icolor name='log-cabin' classes='ui inline mini image'
                .ui.inline.header 
                    |tribes
                if currentUser
                    .ui.basic.cricular.icon.button.add_tribe(title='add tribe')
                        i.plus.icon
                +tribe_cloud filter='tribe'
            .twelve.wide.column
                .ui.icon.input
                    i.search.icon
                    input.ingredient_search(type='text' placeholder='search...')
                |sort by
                .ui.compact.small.menu
                    .ui.simple.dropdown.item
                        strong #{current_meal_sort_label}
                        i.dropdown.icon
                        .menu
                            +set_meal_sort_key key='price_per_serving' label='$/serving' icon='money'
                            +set_meal_sort_key key='datetime_available' label='available' icon='clock'
                            //- +set_meal_sort_key key='_timestamp' label='added' icon='clock'
                            +set_meal_sort_key key='comment_count' label='comment count' icon='chat'
                .ui.compact.icon.basic.circular.button.set_sort_direction(title='toggle sort direction')
                    if sorting_up
                        i.sort.amount.down.icon
                    else
                        i.sort.amount.up.icon
                |&nbsp;
                |&nbsp;
                .ui.inline.small.header
                    |show
                .ui.compact.menu
                    .ui.simple.dropdown.item
                        strong #{meal_limit}
                        i.dropdown.icon
                        .menu
                            +set_meal_limit amount=1
                            +set_meal_limit amount=5
                            +set_meal_limit amount=10
                            +set_meal_limit amount=20
                .scrolling
                    each tribes
                        +tribe_card
                    
                    
                    
                    
template(name='tribe_card')
    .ui.fluid.segment.stackable.grid
        a.four.wide.column(href="/tribe/#{slug}")
            if image_id
                img.ui.fluid.image(src="{{c.url image_id}}")
        .twelve.wide.column
            a.ui.header(href="/tribe/#{slug}")
                |#{title}
            |#{member_ids.length} members
            |!{description}
            //- +ismall name='tags' classes='ui inline image'
            each tags
                .ui.basic.label #{this}
            div
            if is_admin
                .ui.small.header slug: #{slug}
            if can_edit
                a.ui.circular.basic.icon.button(href="/tribe/#{_id}/edit")
                    i.pencil.blue.icon


template(name='tribe_cloud')
    //- #cloud
        //- .ui.left.icon.input
        //-     i.search.icon
        //-     +inputAutocomplete settings=settings id="search" class="" autocomplete="off" 
        // .ui.hidden.fitted.divider
    i.tags.icon
    if selected_tribe_tags
        #clear_tribe_tags.ui.blue.circular.icon.button
            i.remove.icon
        each selected_tribe_tags
            .unselect_tribe_tag.ui.blue.circular.button
                strong #{this}
    each all_tribe_tags
        .ui.button.circular.basic.select_tribe_tag(class=cloud_tag_class) 
            strong #{this.title}

    
                     
                     


template(name='latest_tribe_updates')
    .ui.header 
        +i name='clock'
        |latest tribe updates
    .ui.link.list
        each latest_updates
            a.item(href="/tribe/#{parent_id}/view") 
                +ismall name=tribe.icon
                .ui.small.inline.header 
                    |#{tribe.title}: 
                strong #{text}
            |#{when}
